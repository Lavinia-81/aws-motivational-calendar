const translations = {
  en: {
    title: "🧪 AWS Test – 10 Questions",
    button: "✅ Check Answers",
    feedback: [
      "🌟 Perfect! You're ready for certification!",
      "💪 Great job! Just a bit more practice!",
      "🔄 You're on the right track. Keep going!",
      "📚 Don't give up! Review the concepts and try again."
    ],
    questions: [
      {
        q: "What does Amazon S3 do?",
        a: "a",
        options: ["Stores objects", "Runs EC2 instances", "Manages databases"]
      },
      {
        q: "What is IAM?",
        a: "b",
        options: ["Storage service", "Access control", "Network service"]
      },
      {
        q: "Which EC2 instance type is optimal for intensive processing?",
        a: "c",
        options: ["T2.micro", "M5.large", "C5.xlarge"]
      },
      {
        q: "Which AWS service provides relational databases?",
        a: "a",
        options: ["Amazon RDS", "Amazon DynamoDB", "Amazon S3"]
      },
      {
        q: "What does CloudWatch do?",
        a: "b",
        options: ["Stores logs", "Monitors resources", "Controls access"]
      },
      {
        q: "What is AWS Lambda?",
        a: "c",
        options: ["Storage service", "Network service", "Serverless code execution"]
      },
      {
        q: "Which service provides CDN?",
        a: "a",
        options: ["Amazon CloudFront", "Amazon Route 53", "Amazon S3"]
      },
      {
        q: "What does Route 53 do?",
        a: "b",
        options: ["Stores files", "DNS and routing", "Monitoring"]
      },
      {
        q: "What is Auto Scaling?",
        a: "c",
        options: ["Automatic storage", "Automatic backup", "Automatic instance scaling"]
      },
      {
        q: "What does Elastic Load Balancer do?",
        a: "a",
        options: ["Distributes traffic", "Stores data", "Controls access"]
      },
    ]
  },
  ro: {
    title: "🧪 Test AWS – 10 Intrebări",
    button: "✅ Verifică răspunsurile",
    feedback: [
      "🌟 Perfect! Ești gata de certificare!",
      "💪 Foarte bine! Mai exersează puțin!",
      "🔄 Ești pe drumul cel bun. Continuă!",
      "📚 Nu renunța! Reia conceptele și revino."
    ],
    questions: [
      {
        q: "Ce face Amazon S3?",
        a: "a",
        options: ["Stochează obiecte", "Rulează instanțe EC2", "Gestionează baze de date"]
      },
      {
        q: "Ce este IAM?",
        a: "b",
        options: [ "Serviciu de stocare", "Control acces", "Serviciu de rețea"]
      },
      {
        q: "Ce tip de instanță EC2 e optimă pentru procesare intensivă?",
        a: "c",
        options: ["T2.micro", "M5.large", "C5.xlarge"],
      },
      {
        q: "Ce serviciu AWS oferă baze de date relaționale?",
        a: "a",
        options: ["Amazon RDS", "Amazon DynamoDB", "Amazon S3"],
      },
      {
        q: "Ce face CloudWatch?",
        a: "b",
        options: ["Stochează loguri", "Monitorizează resurse", "Controlează accesul"]
      },
      {
        q: "Ce este AWS Lambda?",
        a: "c",
        options: ["Serviciu de stocare", "Serviciu de rețea", "Execuție cod fără server"]
      },
      {
        q: "Ce serviciu oferă CDN?",
        a: "a",
        options: ["Amazon CloudFront", "Amazon Route 53", "Amazon S3"],
      },
      {
        q: "Ce face Route 53?",
        a: "b",
        options: ["Stochează fișiere", "DNS și routing", "Monitorizare"],
      },
      {
        q: "Ce este Auto Scaling?",
        a: "c",
        options: ["Stocare automată", "Backup automat", "Scalare automată a instanțelor"],
      },
      {
        q: "Ce face Elastic Load Balancer?",
        a: "a",
        options: ["Distribuie traficul", "Stochează date", "Controlează accesul"],
      },
    ]
  },
  es: {
    title: "🧪 Prueba AWS – 10 Preguntas",
    button: "✅ Verificar respuestas",
    feedback: [
      "🌟 ¡Perfecto! ¡Estás listo para la certificación!",
      "💪 ¡Muy bien! ¡Solo un poco más de práctica!",
      "🔄 Vas por buen camino. ¡Sigue así!",
      "📚 ¡No te rindas! Revisa los conceptos y vuelve a intentarlo."
    ],
    questions: [
      {
        q: "¿Qué hace Amazon S3?",
        a: "a",
        options: ["Almacena objetos", "Ejecuta instancias EC2", "Gestiona bases de datos"]
      },
      {
        q: "¿Qué es IAM?",
        a: "b",
        options: ["Servicio de almacenamiento", "Control de acceso", "Servicio de red"]
      },
      {
        q: "¿Qué tipo de instancia EC2 es óptima para procesamiento intensivo?",
        a: "c",
        options: ["T2.micro", "M5.large", "C5.xlarge"]
      },
      {
        q: "¿Qué servicio de AWS ofrece bases de datos relacionales?",
        a: "a",
        options: ["Amazon RDS", "Amazon DynamoDB", "Amazon S3"]
      },
      {
        q: "¿Qué hace CloudWatch?",
        a: "b",
        options: ["Almacena registros", "Monitorea recursos", "Controla el acceso"]
      },
      {
        q: "¿Qué es AWS Lambda?",
        a: "c",
        options: ["Servicio de almacenamiento", "Servicio de red", "Ejecución de código sin servidor"]
      },
      {
        q: "¿Qué servicio ofrece CDN?",
        a: "a",
        options: ["Amazon CloudFront", "Amazon Route 53", "Amazon S3"]
      },
      {
        q: "¿Qué hace Route 53?",
        a: "b",
        options: ["Almacena archivos", "DNS y enrutamiento", "Monitoreo"]
      },
      {
        q: "¿Qué es Auto Scaling?",
        a: "c",
        options: ["Almacenamiento automático", "Copia de seguridad automática", "Escalado automático de instancias"]
      },
      {
        q: "¿Qué hace Elastic Load Balancer?",
        a: "a",
        options: ["Distribuye el tráfico", "Almacena datos", "Controla el acceso"]
      },     
    ]
  },
  fr: {
    title: "🧪 Test AWS – 10 Questions",
    button: "✅ Vérifier les réponses",
    feedback: [
      "🌟 Parfait ! Tu es prêt pour la certification !",
      "💪 Très bien ! Encore un peu de pratique !",
      "🔄 Tu es sur la bonne voie. Continue !",
      "📚 Ne lâche pas ! Revois les concepts et réessaie."
    ],
    questions: [
      {
        q: "Que fait Amazon S3 ?",
        a: "a",
        options: ["Stocke des objets", "Exécute des instances EC2", "Gère des bases de données"]
      },
      {
        q: "Qu'est-ce que IAM ?",
        a: "b",
        options: ["Service de stockage", "Contrôle d'accès", "Service réseau"]
      },
      {
        q: "Quel type d'instance EC2 est optimal pour le traitement intensif ?",
        a: "c",
        options: ["T2.micro", "M5.large", "C5.xlarge"]
      },
      {
        q: "Quel service AWS fournit des bases de données relationnelles ?",
        a: "a",
        options: ["Amazon RDS", "Amazon DynamoDB", "Amazon S3"]
      },
      {
        q: "Que fait CloudWatch ?",
        a: "b",
        options: ["Stocke des journaux", "Surveille les ressources", "Contrôle l'accès"]
      },
      {
        q: "Qu'est-ce que AWS Lambda ?",
        a: "c",
        options: ["Service de stockage", "Service réseau", "Exécution de code sans serveur"]
      },
      {
        q: "Quel service fournit un CDN ?",
        a: "a",
        options: ["Amazon CloudFront", "Amazon Route 53", "Amazon S3"]
      },
      {
        q: "Que fait Route 53 ?",
        a: "b",
        options: ["Stocke des fichiers", "DNS et routage", "Surveillance"]
      },
      {
        q: "Qu'est-ce que Auto Scaling ?",
        a: "c",
        options: ["Stockage automatique", "Sauvegarde automatique", "Mise à l'échelle automatique des instances"]
      },
      {
        q: "Que fait Elastic Load Balancer ?",
        a: "a",
        options: ["Distribue le trafic", "Stocke des données", "Contrôle l'accès"]
      },
      ]
  }
};

let currentLang = "en";


// Function to generate the quiz based on the selected language
function generateQuiz(lang) {
  currentLang = lang;
  const t = translations[lang] || translations.en;
  document.querySelector("h1").textContent = t.title;

  const form = document.getElementById("quiz-form");
  form.innerHTML = "";

  t.questions.forEach((item, index) => {
    const div = document.createElement("div");
    div.className = "question";
    div.innerHTML =
      `<p>${index + 1}. ${item.q}</p>` +
      item.options
        .map(
          (opt, i) =>
            `<label><input type="radio" name="q${index}" value="${String.fromCharCode(
              97 + i
            )}"> ${opt}</label><br>`
        )
        .join("");
    form.appendChild(div);
  });

  const submitBtn = document.createElement("button");
  submitBtn.type = "submit";
  submitBtn.textContent = t.button;
  form.appendChild(submitBtn);

  form.onsubmit = function (e) {
    e.preventDefault();
    let score = 0;
    t.questions.forEach((item, i) => {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (selected && selected.value === item.a) score++;
    });

    let feedback = "";
    if (score === 20) feedback = t.feedback[0];
    else if (score >= 16) feedback = t.feedback[1];
    else if (score >= 10) feedback = t.feedback[2];
    else feedback = t.feedback[3];

    document.getElementById("result").textContent = `You scored ${score}/20. ${feedback}`;
  };
}

// Language selection functionality
document.getElementById("lang-select").addEventListener("change", (e) => {
  generateQuiz(e.target.value);
});

// Initial quiz generation
document.addEventListener("DOMContentLoaded", () => {
  generateQuiz(currentLang);
});

// Theme toggle functionality
document.getElementById("theme-toggle").addEventListener("click", () => {
  document.body.classList.toggle("dark");
});

// Export to PDF functionality
document.getElementById("export-pdf").addEventListener("click", () => {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFontSize(16);
  doc.text("AWS Quiz Results", 10, 20);

  let y = 30;
  const questions = translations[currentLang].questions;

  questions.forEach((item, i) => {
    const selected = document.querySelector(`input[name="q${i}"]:checked`);
    const answer = selected ? selected.value : "—";
    const correct = item.a === answer ? "✔️" : "❌";

    doc.setFontSize(12);
    doc.text(`${i + 1}. ${item.q}`, 10, y);
    y += 6;
    doc.text(`Your answer: ${answer} ${correct}`, 10, y);
    y += 10;

    if (y > 270) {
      doc.addPage();
      y = 20;
    }
  });

  doc.save(`aws_quiz_${currentLang}.pdf`);
});

//Timer functionality
let seconds = 0;

const timerDisplay = document.getElementById("timer");
const form = document.getElementById("quiz-form");
const resultBox = document.getElementById("result");
const timeLimit = 600; // 10 minutes in seconds

function updateTimer() {
  const mins = String(Math.floor(seconds / 60)).padStart(2, "0");
  const secs = String(seconds % 60).padStart(2, "0");
  timerDisplay.textContent = `⏱️ ${mins}:${secs}`;
  seconds++;

  if (seconds >= timeLimit) {
    clearInterval(timerInterval);

    form.querySelectorAll("input").forEach(input => input.disabled = true);
    if (submitBtn) submitBtn.disabled = true;

    resultBox.textContent = "⏳ Time's up! You didn't finish in time. Please try again.";
    resultBox.classList.add("timeout");
    resultBox.style.background = "linear-gradient(135deg, #ff6b6b, #c0392b)";
    resultBox.style.color = "#fff";

    return; // Stop the timer
  }
   seconds++;
}

let timerInterval = setInterval(updateTimer, 1000);